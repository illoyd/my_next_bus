%h1
  #{ @statusboard.stop_name }
  %span.stop-indicator #{ @statusboard.stop_indicator }

= render partial: 'messages', object: @statusboard.high_priority_messages

.predictions
  .header
    %h2.line= Time.now.strftime('%a, %H:%M')
    %h2.next next
    %h2.then then
    
  - if @statusboard.stop.closed?
    = render partial: 'stop_closed'  

  - elsif @statusboard.stop.suspended?
    = render partial: 'stop_suspended'
  
  - elsif @statusboard.stop.temporarily_closed?
    = render partial: 'temporarily_closed'

  - elsif !@statusboard.predictions? || !@statusboard.stop.show_predictions?
    = render partial: 'no_predictions'
  
  - else
    - @statusboard.predictions_by_destination_and_line.each do |destination, lines|
      %h3.destination{ data: {destination: destination} }
        %span.to to
        = destination
      
      - lines.each do |line_name, predictions|
        - next_prediction, then_predictions = predictions.first, predictions.drop(1)
        .prediction{ data: {line: line_name}, class: ('due' if due?(next_prediction)) }
          .line
            .line-name= line_name
          .next
            .time= next_label_for(next_prediction)
          .then
            - then_predictions.each do |then_prediction|
              .time= then_label_for then_prediction

= render partial: 'messages', object: @statusboard.non_high_priority_messages

/ Search for a stop
= render partial: 'inline_search_form', object: params[:id]

/ Start autorefresh
= render partial: 'start_auto_refresh'